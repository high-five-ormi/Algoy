<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>오답노트 상세 페이지</title>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/WrongAnswerNote/view-wrong-answer-note.css">
</head>
<body>
<header>
  <div class="logo">
    <img src="/img/algoy-1.png" alt="ALGoy Logo">
  </div>
  <nav>
    <a href="#">오답 노트</a>
    <a href="#">플래너</a>
  </nav>
  <div class="user-actions">
    <div class="search-bar">
      <input type="text" placeholder="Search">
      <img src="/img/search-glasses.png" alt="Search Icon" class="search-icon">
    </div>
    <button class="logout">Logout</button>
    <div class="logout-container" style="margin-left: 8px;">
      <div class="logout-icon-wrapper">
        <img src="/img/user-icon.png" alt="User Icon" class="logout-icon">
      </div>
    </div>
  </div>
</header>

<!-- 노트 헤더 섹션 -->
<div class="note-header">
  <div class="title-section">
    <img src="/img/planner-icon.png" alt="오답노트 아이콘" class="WrongAnawerNote-icon">
    <h2>오답노트</h2>
  </div>
</div>

<main>
  <section class="note-details">
    <h1 class="note-title">1. [오답노트] 프로그래머스 레벨0 배열 옷가게 할인받기 파이썬</h1>
    <div class="note-meta">
      <span class="author">닉네임</span>
      <span class="date">2024.08.20 19:42</span>
    </div>

    <div class="problem-info">
      <div class="problem-site">
        <strong>문제 링크</strong>
        <p><a href="https://school.programmers.co.kr/learn/courses/30/lessons/120818">https://school.programmers.co.kr/learn/courses/30/lessons/120818</a></p>
      </div>
      <div class="problem-details">
        <div class="detail-item">
          <strong>문제 사이트</strong>
          <p>프로그래머스</p>
        </div>
        <div class="detail-item">
          <strong>유형</strong>
          <p>배열</p>
        </div>
        <div class="detail-item">
          <strong>레벨</strong>
          <p>0</p>
        </div>
      </div>
    </div>

    <div class="content">
      <h3>내용</h3>
      <p>내용내용내용내용내용내용내용내용</p>
    </div>

    <!-- 틀린 코드 박스 및 버튼 -->
    <div class="sample-code-container">
      <div class="sample-code">
        <h3>코드</h3>
        <pre><code class="language-python">
def solution(price):
    answer = 0
    if price >= 100000:
        price *= 0.95
    elif price >= 300000:
        price *= 0.9
    elif price >= 500000:
        price *= 0.8
    return price
        </code></pre>
        <button class="delete-code-btn">삭제</button>
      </div>
    </div>

    <div class="code-action-container">
      <button id="add-code-button">코드 추가</button>
      <div class="action-buttons">
        <!-- Note의 ID는 동적으로 렌더링될 때 서버에서 전달 -->
        <button class="edit-btn" data-note-id="1">수정</button>
        <button class="delete-btn" data-note-id="1">삭제</button>
      </div>
    </div>
  </section>
</main>

<!-- 모달 입력창 -->
<div class="modal" id="codeModal">
  <div class="modal-content">
    <textarea id="codeInput" placeholder="코드를 입력하세요"></textarea>
    <button id="submitCode">추가</button>
    <button id="cancelCode" class="cancel-btn">취소</button>
  </div>
</div>

<!-- 스크립트 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const addCodeButton = document.getElementById('add-code-button');
    const codeModal = document.getElementById('codeModal');
    const submitCode = document.getElementById('submitCode');
    const cancelCode = document.getElementById('cancelCode');
    const codeInput = document.getElementById('codeInput');
    const sampleCodeContainer = document.querySelector('.sample-code-container');

    // 모달 열기
    addCodeButton.addEventListener('click', function() {
      codeModal.style.display = 'flex';
    });

    // 모달 닫기 (취소 버튼)
    cancelCode.addEventListener('click', function() {
      codeModal.style.display = 'none';
      codeInput.value = ''; // 입력 필드 초기화
    });

    // 코드 추가 (추가 버튼)
    submitCode.addEventListener('click', function() {
      const codeContent = codeInput.value.trim();
      if (codeContent) {
        const codeBlock = document.createElement('div');
        codeBlock.classList.add('sample-code');
        codeBlock.innerHTML = `
          <h3>코드</h3>
          <pre><code class="language-python">${codeContent}</code></pre>
          <button class="delete-code-btn">삭제</button>
        `;
        sampleCodeContainer.appendChild(codeBlock);

        // 새로 추가된 삭제 버튼에 이벤트 리스너 추가
        const deleteBtn = codeBlock.querySelector('.delete-code-btn');
        deleteBtn.addEventListener('click', function() {
          codeBlock.remove();
        });

        codeModal.style.display = 'none';
        codeInput.value = ''; // 입력 필드 초기화
      }
    });

    // 수정 버튼 클릭 시 수정 페이지로 이동
    const editButtons = document.querySelectorAll('.edit-btn');
    editButtons.forEach((btn) => {
      btn.addEventListener('click', function() {
        const noteId = this.dataset.noteId;
        window.location.href = `/algoy/commit/${noteId}/edit`; // 수정 페이지로 이동
      });
    });

    // 삭제 버튼 클릭 시 삭제 요청
    const deleteButtons = document.querySelectorAll('.delete-btn');
    deleteButtons.forEach((btn) => {
      btn.addEventListener('click', function() {
        const noteId = this.dataset.noteId;
        if (confirm('정말 삭제하시겠습니까?')) {
          window.location.href = `/algoy/commit/${noteId}/delete`; // 삭제 요청
        }
      });
    });

    // 초기 삭제 버튼에 이벤트 리스너 추가
    const initialDeleteBtn = document.querySelector('.delete-code-btn');
    if (initialDeleteBtn) {
      initialDeleteBtn.addEventListener('click', function() {
        initialDeleteBtn.closest('.sample-code').remove();
      });
    }
  });
</script>
</body>
</html>